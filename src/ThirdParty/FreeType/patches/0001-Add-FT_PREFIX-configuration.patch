From ad5e82d989f3e43c181d02a1c9326d49c054151e Mon Sep 17 00:00:00 2001
From: Peter Zhigalov <peter.zhigalov@gmail.com>
Date: Sat, 24 Aug 2024 05:38:07 +0700
Subject: [PATCH] Add FT_PREFIX configuration

---
 include/freetype/internal/ftcalc.h | 2 +-
 include/ft2build.h                 | 4 ++++
 src/base/ftcalc.c                  | 2 +-
 3 files changed, 6 insertions(+), 2 deletions(-)

diff --git a/include/freetype/internal/ftcalc.h b/include/freetype/internal/ftcalc.h
index 16a7322..7a71f08 100644
--- a/include/freetype/internal/ftcalc.h
+++ b/include/freetype/internal/ftcalc.h
@@ -419,7 +419,7 @@ FT_BEGIN_HEADER
 #endif /* !FT_CONFIG_OPTION_NO_ASSEMBLER */
 
 
-#ifndef FT_MSB
+#if !defined (FT_MSB) || defined (FT_MSB_USE_C_IMPL)
 
   FT_BASE( FT_Int )
   FT_MSB( FT_UInt32  z );
diff --git a/include/ft2build.h b/include/ft2build.h
index 3008aea..75b8da0 100644
--- a/include/ft2build.h
+++ b/include/ft2build.h
@@ -34,6 +34,10 @@
 #ifndef FT2BUILD_H_
 #define FT2BUILD_H_
 
+#if defined (FT_PREFIX)
+#include "ftprefix.h"
+#endif
+
 #include <freetype/config/ftheader.h>
 
 #endif /* FT2BUILD_H_ */
diff --git a/src/base/ftcalc.c b/src/base/ftcalc.c
index 7d6e12e..0c61e6d 100644
--- a/src/base/ftcalc.c
+++ b/src/base/ftcalc.c
@@ -96,7 +96,7 @@
     return a & ~0xFFFFL;
   }
 
-#ifndef FT_MSB
+#if !defined (FT_MSB) || defined (FT_MSB_USE_C_IMPL)
 
   FT_BASE_DEF( FT_Int )
   FT_MSB( FT_UInt32 z )
-- 
2.47.3

